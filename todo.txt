Why-Combinator (YC): Product Requirements Document (Todo Format)
Tech Stack: Python CLI (Typer/Rich), TinyDB/JSON+SQLite, Ollama/Huggingface/LLM APIs, D3.js (future web UI)
Philosophy: Backend-first, local-first, CLI-driven with ASCII visualization. Research reproducibility + economic plausibility.
================================================================================

# Stability/Scaling: Async, Storage, Error Handling, Tests






(B) Add test: CLI run command executes N ticks with mock LLM and produces expected metric count +test
(B) Add test: CLI export command generates valid JSON/CSV/Markdown output files +test
(B) Add test: OllamaProvider retries on 429 status and succeeds on subsequent attempt (mock httpx) +test
(B) Add test: OpenAIProvider exponential backoff timing is correct across 3 retries (mock httpx) +test
(B) Add test: AnthropicProvider handles missing API key with clear ConfigError +test
(B) Add test: CachedLLMProvider returns identical response for identical prompt+model (determinism) +test
(B) Add test: GenericAgent falls back to wait action when LLM returns malformed JSON +test
(B) Add test: GenericAgent.perceive() handles missing world_state keys without KeyError +test
(B) Add test: RelationshipGraph strength decays correctly over N ticks without interaction +test
(B) Add test: CoalitionManager detects coalition when 3+ agents have mutual positive relationships +test
(B) Add test: SentimentTracker correctly scores positive/negative/neutral actions +test
(B) Add test: EmergenceDetector flags repeated action pattern as emergent behavior +test
(B) Add test: MultiPhaseManager transitions from mvp to launch when adoption threshold met +test
(B) Add test: BatchWriter flushes all buffered interactions on explicit flush() call +test
(B) Add test: AgentPool rotates agents correctly when pool size exceeds active limit +test
(B) Add test: ExperimentConfig diff correctly identifies changed variables between two configs +test
(B) Add test: cross-simulation metric aggregation returns correct mean/stddev across 3 mock sims +test
(B) Add test: market saturation mechanic reduces adoption growth rate as market_share approaches TAM +test
(B) Add test: agent memory eviction keeps max_memory_size entries and summarizes overflow +test
(B) Add test: LLM provider fallback chain activates mock when no API keys are configured +test
(B) Add pytest-asyncio to dev dependencies and async test fixtures for async engine tests +test +infra
(B) Add mypy to dev dependencies; create mypy.ini with strict mode for src/why_combinator/ +infra
(B) Add pre-commit hook running mypy and pytest via pyproject.toml scripts entry +infra